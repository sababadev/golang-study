Клон Реддита

Продолжаем работать с клоном реддита.

Поскольку лекция посвящена работе с базами - в этот раз мы будем заниматься базами:

1) Хранить сессии в mysql. В JWT сессии использовать больше нельзя в режиме stateless. Теперь они будут stateful ( храниться в базе ), это значит что по прихорду сессии в идете в базу и проверяете, есть-ли там запись с тами ИД-шником. Для хранения сессий надо использовать redis/memcached/tarantool
2) Хранить пользователей в mysql/postgres.
3) Хранить посты с комментами в MondoDB ( использовать github.com/mongodb/mongo-go-driver )

Надо сделать тестовое покрытие с использованием моков ( моков репозтория, моков базы ) > 60%.
В идеале - для одной сущности сделать полное ( 100% ) покрытие структуры ( как http-хендлера, так и репозитория ), например для юзера. Не упарывайтесь со 100%-м покрытием постов, там много. Но надо сделать всего по чуть-чуть, чтобы понять все варианты. И не забудьте что есть еще функциональное тестирование (когда работает с кодом как с черным ящиком - пример таких тестов в db_explorer)

Надо скопировать в соответствующую папку (6/99_hw/redditclone) ваш код из предыдущего задания (5/99_hw/redditclone) и писать в новой папке (6/99_hw/redditclone). Чтобы не смешивалось.

Ссылки в помощь:
* https://medium.com/better-programming/unit-testing-code-using-the-mongo-go-driver-in-golang-7166d1aa72c0

Это задание позволить поработать с основными вещами, которые используются при разработке приложений:
1) Проектировать простые таблицы в mysql
2) Писать основные запросы к mysql
3) Тестировать паттерн репозрторий с mysql и mongodb
4) Тестировать http хендлеры которые приближены к реальности, а не фейковые, как в 4-м задании

Реализовать это можно через отдельные структуры, удовлетворяющие заданному интерфейсу. Рядом с другим репозиторием, например будет session_jwt.go + session_mysql.go + session_redis.go